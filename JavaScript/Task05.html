<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>基础JavaScript练习二</title>
	<link rel="stylesheet" type="text/css" href="css/normalize.css">
	<style type="text/css">
		.wrapper{
			width: 800px;
			margin: 100px auto;
		}
		ul{
			list-style: none;
			padding: 0;
			overflow:hidden;
		}
		li{
			min-width: 5px;
			cursor: pointer;
			margin-left: 5px;
			padding: 5px;
			text-align: center;
			background-color: darkred;
			display: inline-block;
			vertical-align: bottom;
		}
		
		li:first-child{
			margin-left: 0;
		}
	</style>
	<script type="text/javascript">
		/**
		*	addEventListener	支持IE8+浏览器,事件名称前不用加on
		*	attachEvent			用于<=IE8 或 Opera 7.0 及 Opera事件处理，事件名称前要加on关键字
		*/
		var setting = {
						minValue:10,
						maxValue:100,
						maxCount:60
					};
		function addEventListener(elm,etype,func){
			if(elm){
				if(elm.addEventListener){
					elm.addEventListener(etype,func);
				}else{
					elm.attachEvent('on'+etype,func);
				}
			}
		}
		function removeEventListener(elm,etype,func){
			if(elm){
				if(elm.addEventListener){
					elm.removeEventListener(etype,func);
				}else{
					elm.detachEvent('on'+etype,func);
				}
			}
		}
		var inputValue = null,listContainer = null,liItems = null;
		function outValue(direction){
			var ilen = liItems.length;
			if(ilen>0){
				if(direction==-1){
					removeLiItem(liItems[0]);
				}else{
					removeLiItem(liItems[ilen-1]);
				}
			}
		}
		function removeLiItem(obj){
			removeEventListener(obj,'click',removeValueItem);
			listContainer.removeChild(obj);
		}
		function removeValueItem(){
			removeLiItem(this);
		}
		function intoValue(direction){			
			var value = parseInt(inputValue.value);
			if(liItems.length>=setting.maxCount){
				alert(value);
				return;
			}
			if(value>=setting.minValue && value<=setting.maxValue){
				var li = document.createElement('li');
				li.value = value;
				if(liItems.length==0 || direction==1){
					listContainer.appendChild(li);
				}else{
					listContainer.insertBefore(li,liItems[0]);
				}
				li.style.height = value + 'px';
				addEventListener(li,'click',removeValueItem)
				inputValue.value = '';				
			}else{
				alert('请输入' + setting.minValue +' ~ ' + setting.maxValue + ' 之间的数字。');
			}
		}
		function resort(){
			var len = liItems.length;
			if(len>1){
				var nArr = [];
				for(var i=0;i<len;i+=1){
					var index = -1;
					var iv = liItems[i];
					for(var n=0,nlen=nArr.length;n<nlen;n++){						
						var nv = nArr[n];
						if(iv.value>nv.value){
							index = n;
							break;
						}
					}
					if(index!=-1)nArr.splice(index,0,iv);
					else nArr.push(iv);
				}
				for(i=0;i<len;i+=1)listContainer.appendChild(nArr[i]);
			}
		}
		function getElementById(id){
			return document.getElementById(id);
		}
		window.onload = function(){
			var eventTargets = [{
						btn:getElementById('into-left'),
						call:intoValue,
						param:-1,
					},{
						btn:getElementById('into-right'),
						call:intoValue,
						param:1,
					},{
						btn:getElementById('out-left'),
						call:outValue,
						param:-1,
					},{
						btn:getElementById('out-right'),
						call:outValue,
						param:1,
					},{
						btn:getElementById('sort-btn'),
						call:resort
					}];
			inputValue = getElementById('input-value');
			listContainer = getElementById('list-container');
			liItems = listContainer && listContainer.getElementsByTagName('li');

			for(var i=0,len=eventTargets.length;i<len;i++){
				(function(item){
					addEventListener(item.btn,'click',function(){
						item.call(item.param);
					});
				})(eventTargets[i]);
			}
		}
	</script>
</head>
<body>
	<div class="wrapper">
		<input type="text" id='input-value'>
		<button id='into-left'>左侧入</button>
		<button id='into-right'>右侧入</button>
		<button id='out-left'>左侧出</button>
		<button id='out-right'>右侧出</button>
		<button id="sort-btn">排序</button>
		<ul id='list-container'>
		</ul>
	</div>
</body>
</html>